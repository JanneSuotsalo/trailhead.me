# Trailhead

A social platform for people who love outdoors.

Developed by **Tuomas PÃ¶yry**, **Mikko Romo** & **Janne Suotsalo**

[https://trailhead.me/](https://trailhead.me/)

## Setup

### Database

MariaDB version 10.3 or higher is **REQUIRED**!

### .env

```
PORT = 3000
NODE_ENV = development

SALT_ROUNDS = 8
COOKIE_KEY = [LONG RANDOM STRING]
HASH_KEY = [LONG RANDOM STRING]

MAP_KEY = https://maps.tilehosting.com/c/91c5c235-561d-419f-8206-97e53ba6d9cf/styles/trailhead-b4cc1/style.json?key=7QdiOvVQ72TrAs6GCdnN
GEO_KEY =

DB_HOST = [DATABASE URL OR IP]
DB_DATABASE = [DATABASE NAME]
DB_USER = [DATABASE USER]
DB_PASSWORD = [DATABASE USER PASSWORD]
```

`NODE_ENV` decides if HTTPS should be enabled, if set to development, HTTPS is disabled and `PORT` is used.  
`MAP_KEY` is the key to the visual theme of the create post map, not required but highly recommended.  
`GEO_KEY` is the key to the geo.trailhead.me API that generates the small images behind location previews, not required.

### SSL Certificates

**NOTE:** Only required if `NODE_ENV` is set to "production".  
Should be located in the folder /cert located in the project root.

```
./cert/ca_bundle.crt
./cert/certificate.crt
./cert/private.key
```

### Install

```
npm install
```

### Start

```
npm start
```

## Features

### General

- Users
  - Login & register
  - Normal & admin users
- Posting of images and videos
  - Multiple media items per post
  - Location attached to post
  - Text attached to post
    - Supports searchable tags (#)
  - Comments on a post
  - Reacting to posts with emojis
- Feeds
  - Personal feed with posts from followers
  - Global feed with all posts
  - Trending tags and locations in the sidebar
- Search
  - Searches for users, tags & locations
  - Can be filtered to search only one type

### Backend (Notable features)

- "Framework" built on top of express
  - Handles adding routes
  - Handles errors in a user friendly manner
  - Creates and handles DB transactions for each request
  - Handles user authentication
  - Handles data serialization and returning based on the type of request
- File resizing
  - Files can be requested in different sizes based on the URL
    - file/ID
    - file/ID/(xs, s, m, l, xl)
    - file/ID/(width)/(height)
  - Can be configured to cache transformed images
    - Not enabled currenty, resizing on the fly does not affect performance that much
- Gulp build system for front-end assets
  - Transpiles and compresses .js with babel
    - Supports source files
  - Compiles .scss files to .css
  - Bundles & compresses external libraries together
- HTTPS support
  - Redirects HTTP requests automatically
  - Can be disabled by setting NODE_ENV to "development"

### Front-end (Notable features)

- Coherent, custom design
  - Not based on anything, takes inspiration from material desing
- "Geo" preview
  - Preview images for locations are generated by the geo.trailhead.me API
    - Code is open source and can be found at [here.](https://github.com/Munkkeli/trailhead-geo)
  - Adds interesting and unique visual to each location
